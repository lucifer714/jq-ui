(function($){function initPanel($panel,options,content){if(!options["title"]){return}var $header=$("<div></div>").addClass("panel-header").append($("<div></div>").addClass("panel-title").html(options["title"]));var $content=$("<div></div>").addClass("panel-content").html(content);$panel.append($header).append($content)}function initSize($panel,options){if(options["width"]){$panel.css("width",options["width"])}if(options["height"]){$panel.css("height",options["height"])}setTimeout(function(){$panel.find(".panel-content").css({"width":($panel.width()-20),"height":($panel.height()-46)})},10)}function load($panel,options){if(options["url"]){_load($panel,options["url"])}}function _load($panel,url){if(!url){var options=$.data($panel[0],"panel");url=options["url"]}if(!url){return}$.ajax({type:"post",dataType:"html",url:url,cache:false,success:function(data){$panel.find("div.panel-content").html(data)}})}$.fn.panel=function(options,param){if(typeof options=="string"){switch(options){case"reload":return this.each(function(){_load($(this),param)});case"options":return this.each(function(){return $.data(this,"panel")})}}var defaults={title:"",width:"0",height:"0",url:""};var options=$.extend(defaults,options);return this.each(function(){var $panel=$(this);$panel.addClass("panel");$.data(this,"panel",options);var content=$panel.html();$panel.html("");initPanel($panel,options,content);load($panel,options);initSize($panel,options)})}})(jQuery);
(function($){function createButton(text,fn){return $("<button>"+text+"</button>").addClass("default-button").click(function(){$.dialog.close($(this).parentsUntil(".dialog-container").parent().attr("id"),fn)})}function setTimer(dialog,t){if(t>0){setTimeout(function(){$.dialog.close(dialog[0].id)},t)}}$.messager={__top:3,alert:function(options){var defaultSettings={title:"信息",width:250,height:170,content:"页面出现错误。",level:"warning",btn:"确定",callback:null,modal:true,time:0,showType:""};var options=$.extend(defaultSettings,options);var messageContent=$("<div></div>").addClass("message-content").append($("<span></span>").addClass("message-"+options["level"]+"-icon message-icon")).append($("<span>"+options["content"]+"</span>"));var messageButtonContainer=$("<div></div>").addClass("message-button-container");messageButtonContainer.append(createButton(options["btn"],null));var alertDialog=$.dialog.open({title:options["title"],width:options["width"],height:options["height"],top:this.__top,html:[messageContent,messageButtonContainer],modal:options["modal"],showType:options["showType"],onClose:options["callback"]});setTimer(alertDialog,options["time"])},confirm:function(options){var defaultSettings={title:"确认",width:250,height:170,content:"请确认？",modal:true,btn:[{text:"确定",callback:function(){}},{text:"取消",callback:function(){}}],showType:""};var options=$.extend(defaultSettings,options);var messageContent=$("<div></div>").addClass("message-content").append($("<span></span>").addClass("message-question-icon message-icon")).append($("<span>"+options["content"]+"</span>"));var messageButtonContainer=$("<div></div>").addClass("message-button-container");for(var i=0;i<options["btn"].length;i++){var b=options["btn"][i];messageButtonContainer.append(createButton(b["text"],b["callback"]))}$.dialog.open({title:options["title"],width:options["width"],height:options["height"],top:this.__top,html:[messageContent,messageButtonContainer],modal:options["modal"],showType:options["showType"]})},message:function(options){var defaultSettings={title:"信息",width:250,height:120,content:"操作成功。",callback:null,modal:false,time:0,showType:""};
var options=$.extend(defaultSettings,options);var messageContent=$("<div></div>").addClass("message-content").css("text-align","center").append($("<span>"+options["content"]+"</span>"));var msgDialog=$.dialog.open({title:options["title"],width:options["width"],height:options["height"],top:this.__top,html:[messageContent],modal:options["modal"],showType:options["showType"],onClose:options["callback"]});setTimer(msgDialog,options["time"])}}})(jQuery);
(function($){window["zIndex"]=1100;function initDialog(id,title){var $dialog=$("<div></div>").attr("id",id).addClass("dialog-container");var $header=$("<div></div>").addClass("dialog-header").append($("<div>"+title+"</div>").addClass("dialog-title")).append($("<div></div>").addClass("dialog-close"));var $content=$("<div></div>").addClass("dialog-content");return $dialog.append($header).append($content)}function initSize(dialog,options){var screenWidth=$(document.body).width();var screenHeight=$(window).height();dialog.css({"width":options["width"],"height":options["height"],"top":(screenHeight-options["height"])/options["top"],"left":(screenWidth-options["width"])/2});dialog.find("div.dialog-content").css({"width":options["width"]-32,"height":options["height"]-57})}function bindEvent(dialog){dialog.find("div.dialog-close").click(function(){$.dialog.close(dialog[0].id);if($(".dialog-mask")[0]){$(".dialog-mask").remove()}})}function bindDrag(dialog){var mX=0,mY=0;var dX=0,dY=0;var isDown=false;if(document.attachEvent){dialog[0].attachEvent("onselectstart",function(){return false})}dialog.find("div.dialog-header").mousedown(function(event){this.style.cursor="move";var event=event||window.event;mX=event.screenX;mY=event.screenY;dX=parseFloat(dialog.css("left"));dY=parseFloat(dialog.css("top"));isDown=true});$(document).mousemove(function(event){var event=event||window.event;var x=event.screenX;var y=event.screenY;if(isDown){dialog.css({"left":x-mX+dX,"top":y-mY+dY})}});$(document).mouseup(function(){dialog.find("div.dialog-header").css("cursor","default");isDown=false})}function load(dialog,options){var content=options["content"];if(content){dialog.find("div.dialog-content").html(content);return}var html=options["html"];if(html){for(var i=0;i<html.length;i++){dialog.find("div.dialog-content").append(html[i])}return}var url=options["url"];if(url){ajaxLoad(dialog,url)}}function ajaxLoad(dialog,url){$.ajax({type:"post",dataType:"html",url:url,cache:false,success:function(data){dialog.find("div.dialog-content").html(data)
}})}function createMask(){return $("<div class='dialog-mask'></div>").css("z-index",++window["zIndex"]).appendTo($("body"))}var show={slide:function(dialog){dialog.slideDown("100")},fade:function(dialog){dialog.fadeIn("100")}};var hide={slide:function(dialog,fn){dialog.slideUp("100",function(){dialog.remove();if(fn){fn()}})},fade:function(dialog,fn){dialog.fadeOut("100",function(){dialog.remove();if(fn){fn()}})}};$.dialog={open:function(options){var dialog=this.create(options);dialog.css({"z-index":++window["zIndex"],"display":"none"}).appendTo($("body"));if(options["showType"]){show[options["showType"]](dialog)}else{dialog.css("display","block")}return dialog},create:function(options){var defaultSettings={id:undefined,title:undefined,width:500,height:300,top:3,modal:false,url:"",content:"",html:undefined,showType:"",onClose:null};var options=$.extend(defaultSettings,options);var dialogId=options["id"];if(dialogId===undefined||dialogId==null||dialogId.replace(/(^\s*)|(\s*$)/g,"")==""){dialogId="jquery_dialog_"+new Date().getTime()}if($("#"+dialogId)[0]){return $("#"+dialogId)}var title=options["title"];if(title==undefined||title==null){title=dialogId}var dialog=initDialog(dialogId,title);initSize(dialog,options);bindEvent(dialog);bindDrag(dialog);load(dialog,options);if(options["modal"]){createMask()}$.data(dialog[0],"dialog",options);return dialog},close:function(id,c){var dialog=$("#"+id);if(dialog[0]){var options=$.data(dialog[0],"dialog");if(options["showType"]){hide[options["showType"]](dialog,c||options["onClose"])}else{dialog.remove();var f=c||options["onClose"];if(f){f()}}if($(".dialog-mask")[0]){$(".dialog-mask").remove()}}},reload:function(id){var dialog=$("#"+id);if(dialog[0]){var options=$.data(dialog[0],"dialog");if(options["url"]){ajaxLoad(dialog,options["url"])}}}}})(jQuery);
(function($){function initTable($datatable){var options=$.data($datatable[0],"datatable");var tr=$("<tr></tr>");if(options["showCheckbox"]){tr.append("<th style='text-align:center'>选择</th>")}for(var i=0;i<options["columns"].length;i++){var th=$("<th>"+options["columns"][i]["columnName"]+"</th>");if(options["columns"][i]["css"]){th.css(options["columns"][i]["css"])}tr.append(th)}$("<thead></thead>").append(tr).appendTo($datatable.addClass("datatable").attr({"cellpadding":"0","cellspacing":"0"}));var wrap=$("<div></div>").addClass("datatable-wrapper");wrap.css({"width":options["width"],"height":options["height"]});$datatable.append("<tbody></tbody>").wrap(wrap)}function loadData($datatable){var options=$.data($datatable[0],"datatable");var url=options["url"];$.ajax({type:options["method"]||"post",dataType:"json",url:url,data:{"pageNum":options["pageNum"],"pageSize":options["pageSize"]},success:function(data){$.data($datatable[0],"data",data["rows"]);var tbody=$datatable.find("tbody").empty();for(var i=0;i<data["rows"].length;i++){var user=data["rows"][i];var tr=$("<tr></tr>");if(options["showCheckbox"]){tr.append("<td style='text-align:center'><input type='checkbox' row-id='"+i+"' /></td>")}for(var j=0;j<options["columns"].length;j++){var v=user[options["columns"][j]["field"]];var format=options["columns"][j]["format"];if(format){v=format(v)}var td=$("<td>"+v+"</td>");if(options["columns"][j]["css"]){td.css(options["columns"][j]["css"])}tr.append(td)}tbody.append(tr)}if(options["pagination"]){$datatable.parent().find(".pagination").remove();var $pagination=$("<div></div>").css("margin-top","10px");$pagination.pagination({pageNum:options["pageNum"],size:options["pageSize"],total:data["totalPage"],click:function(curr,s){options["pageNum"]=curr;$.data(this,"datatable",options);loadData($datatable);return data["totalPage"]}});$datatable.parent().append($pagination)}}})}function getSelectRows($datatable){var trs=$datatable.find("tbody tr");var data=$.data($datatable[0],"data");
var rows=new Array();for(var i=0;i<trs.length;i++){var checked=$(trs[i]).children().eq(0).find("input[row-id]").prop("checked");if(checked){rows.push(data[i])}}return rows}$.fn.datatable=function(options,param){if(typeof options=="string"){switch(options){case"reload":return this.each(function(){loadData($(this))});case"getSelectRows":return getSelectRows($(this))}}var defaults={width:"100%",height:"auto",columns:[],url:"",pageNum:1,pageSize:10,pagination:true,showCheckbox:false};var options=$.extend(defaults,options);return this.each(function(){$.data(this,"datatable",options);var datatable=$(this);initTable(datatable);loadData(datatable)})}})(jQuery);
(function($){function init($pagination){$pagination.addClass("pagination").append($('<a href="javascript:;" class="first">首页</a>')).append($('<a href="javascript:;" class="prev">上一页</a>')).append($('<div class="page-container"></div>')).append($('<a href="javascript:;" class="next">下一页</a>')).append($('<a href="javascript:;" class="last">尾页</a>'));var options=$.data($pagination[0],"pagination");toPage($pagination,options["pageNum"],options["total"],options["size"])}function initEvents($pagination){var options=$.data($pagination[0],"pagination");var totalFn=options["click"];$pagination.find(".page-container").delegate(".page-num","click",function(){if($(this).hasClass("current-page")){return}var current=parseInt($(this).html());toPage($pagination,current,totalFn(current,options["size"]),options["size"])});$pagination.delegate(".first","click",function(){var current=parseInt($pagination.find(".page-container .current-page").html());if(current<=1){return}toPage($pagination,1,totalFn(1,options["size"]),options["size"])}).delegate(".prev","click",function(){var current=parseInt($pagination.find(".page-container .current-page").html())-1;if(current<1){return}toPage($pagination,current,totalFn(current,options["size"]),options["size"])}).delegate(".next","click",function(){var current=parseInt($pagination.find(".page-container .current-page").html())+1;if(current>options["total"]){return}toPage($pagination,current,totalFn(current,options["size"]),options["size"])}).delegate(".last","click",function(){var current=parseInt($pagination.find(".page-container .current-page").html());if(current>=options["total"]){return}toPage($pagination,options["total"],totalFn(options["total"],options["size"]),options["size"])})}function getCurrentPage($pagination){return parseInt($pagination.find(".page-container .current-page").html())}function getSize($pagination){var options=$.data($pagination[0],"pagination");return options["size"]}function toPage($pagination,current,total,size){$($pagination).find(".first, .prev, .next, .last").removeClass("disable-page");
if(current==1){$pagination.find(".first, .prev").addClass("disable-page")}if(current==total){$pagination.find(".next, .last").addClass("disable-page")}var front,behind,c;if(size%2==0){front=size/2-1;behind=size/2;c=size/2}else{front=Math.floor(size/2);behind=Math.floor(size/2);c=Math.ceil(size/2)}var start,end;if(total<=size){start=1;end=total}else{if(current<=c){start=1;end=size}else{if((current+behind)>total){start=total-size+1;end=total}else{start=current-front;end=current+behind}}}var $pageContainer=$pagination.find(".page-container");$pageContainer.empty();for(var i=start;i<=end;i++){$pageContainer.append($('<a href="javascript:;" class="page-num" title="'+i+'">'+i+"</a>"))}$pageContainer.children("a[title='"+current+"']").addClass("current-page")}$.fn.pagination=function(options,param){if(typeof options=="string"){switch(options){case"getCurrentPage":return getCurrentPage($(this));case"toPage":return this.each(function(){param=$.extend($.data(this,"pagination"),param);toPage($(this),param["current"],param["total"],param["size"])});case"getSize":return getSize($(this))}}var defaults={pageNum:1,size:10,total:1,click:function(){return 1}};var options=$.extend(defaults,options);return this.each(function(){$.data(this,"pagination",options);var pagination=$(this);init(pagination);initEvents(pagination)})}})(jQuery);
(function($){function init($accordion){$accordion.addClass("accordion").children("li:even").addClass("accordion-title").end().children("li:odd").addClass("accordion-body").css("display","none").end().children("li.accordion-title").filter(".active").next().slideDown("100")}function initEvents($accordion){$accordion.delegate(".accordion-title","click",function(){select($accordion,$(this).attr("accordion-id"))})}function select($accordion,accordionId){var t=$accordion.children("li[accordion-id="+accordionId+"]").next();if(t.css("display")==="none"){t.slideDown("100").siblings(".accordion-body").slideUp("100")}else{t.slideUp("100")}}function isSelected($accordion,accordionId){return $accordion.children("li[accordion-id="+accordionId+"]").hasClass("active")}$.fn.accordion=function(options,param){if(typeof options=="string"){switch(options){case"select":return this.each(function(){select(accordion,param)});case"isSelected":return isSelected(accordion,param)}}options=options||{};return this.each(function(){var accordion=$(this);init(accordion);initEvents(accordion)})}})(jQuery);
(function($){function initTab($tab){$tab.addClass("tab").children("ul").addClass("tab-header").append($("<li></li>").addClass("tab-header-items").css("width",$tab.outerWidth()-25).append("<ul></ul>")).append($("<li></li>").addClass("tab-header-select tab-header-select-down").css("title","显示隐藏").append("<ul class='hide-title-list'></ul>"));$tab.append($("<ul></ul>").addClass("tab-overflow-items")).children("div").addClass("tab-content")}function initContentHeight($tab){$tab.css("height",($tab.parent().height()-2)+"px").find(".tab-content").css("height",($tab.parent().height()-58)+"px")}function initEvents($tab){$tab.delegate(".tab-header-item","click",function(){var selected=$(this).hasClass("tab-header-selected");if(!selected){selectTab($tab,$(this).attr("target"))}}).delegate(".tab-header-select","click",function(){if($(this).hasClass("tab-header-select-down")&&$(this).children().children().length>0){$(this).removeClass("tab-header-select-down").addClass("tab-header-select-up");$(this).children().css("display","block")}else{$(this).removeClass("tab-header-select-up").addClass("tab-header-select-down");$(this).children().css("display","none")}}).delegate(".tab-header-select ul li","click",function(){var tabId=$(this).attr("item-id");selectTab($tab,tabId)}).delegate(".close","click",function(){var tabId=$(this).parent().attr("target");removeTab($tab,tabId)})}function initContextMenu(){var contextMenu=$("body .tab-contextmenu");if(!contextMenu[0]){$("<div class='tab-contextmenu'></div>").append(createContextMenuItem("关闭当前标签","current")).append(createContextMenuItem("关闭左侧标签","prevAll")).append(createContextMenuItem("关闭右侧标签","nextAll")).append(createContextMenuItem("关闭其他","other")).append(createContextMenuItem("关闭全部","all")).appendTo("body")}function createContextMenuItem(text,target){return $("<div class='tab-contextmenu-item'></div>").html(text).attr("target",target)}}function initWindowContextMenu(){$("body").bind("contextmenu",contextMenuHandler).on("click",function(ev){$(".tab-contextmenu").css("display","none");
var e=ev||window.event;var src=$(e.srcElement||e.target);if(!src.hasClass("tab-header-select")){closeSelect()}})}function contextMenuHandler(ev){closeSelect();var e=ev||window.event;var menu=$(".tab-contextmenu");src=$(e.srcElement||e.target);if(src.hasClass("tab-header-item")){var tab=src.parentsUntil(".tab").parent();tab.tab("selectTab",src.attr("target"));e.preventDefault();menu.css({"left":e.clientX+"px","top":e.clientY+"px","display":"block"}).children().unbind("click").bind("click",function(){switch($(this).attr("target")){case"current":return removeTabs(tab,src);case"prevAll":return removeTabs(tab,src.prevAll());case"nextAll":removeHideTitles(tab);return removeTabs(tab,src.nextAll());case"other":removeHideTitles(tab);return removeTabs(tab,src.siblings());case"all":removeHideTitles(tab);return removeTabs(tab,src.parent().children())}})}else{menu.css("display","none")}}function addTab($tab,param){if(isExists($tab,param["id"])){selectTab($tab,param["id"])}else{$tab.find(".tab-header-item").removeClass("tab-header-selected");$newHeaderItem=$("<li></li>");$newHeaderItem.text(param["title"]).attr("target",param["id"]).addClass("tab-header-item").addClass("tab-header-selected").append($('<span class="close"></span>')).appendTo($tab.find(".tab-header-items").children("ul"));$tab.children("div").children().addClass("hide");$newContentItem=$("<div></div>");$newContentItem.html(param["content"]).attr("id",param["id"]).addClass("tab-content-item").appendTo($tab.children("div"));afterAddTab($tab)}}function afterAddTab($tab){var headItem=$tab.find(".tab-header-items");var titles=headItem.find("ul").children();if(titles.length<=1){return}var w1=titles.eq(0).offset().left;var w2=titles.eq(titles.length-1).offset().left;if(w2>w1){return}var headerWidth=headItem.outerWidth();var tmp=titles.eq(titles.length-1).outerWidth(true);var maxVisible=0;titles.each(function(i){var w=$(this).outerWidth(true);tmp+=w;if(tmp>headerWidth){maxVisible=i;return false}});var select=$tab.find(".tab-header-select ul");
for(var j=maxVisible;j<titles.length-1;j++){var t=titles.eq(j);t.removeClass("tab-header-selected").attr("real-width",t.outerWidth()).appendTo($tab.find(".tab-overflow-items"));select.append("<li item-id='"+t.attr("target")+"'>"+t.text()+"</li>")}}function closeSelect(){if($(".tab-header-select").hasClass("tab-header-select-up")){$(".tab-header-select").removeClass("tab-header-select-up").addClass("tab-header-select-down").children().css("display","none")}}function removeHideTitles($tab){$tab.find(".tab-overflow-items").children().remove();$tab.find(".hide-title-list").children().remove()}function addRemoteTab($tab,param){addTab($tab,{"title":param["title"],"id":param["id"],"content":""});$.ajax({type:param["method"]||"post",dataType:"html",url:param["url"],cache:false,success:function(data){$tab.find("#"+param["id"]).html(data)}})}function removeTab($tab,tabId){var headerItem=$tab.find(".tab-header-items ul").children("li[target="+tabId+"]");var selected=headerItem.hasClass("tab-header-selected");var prevItem=headerItem.prev();var nextSelectedId=null;if(!prevItem[0]){prevItem=headerItem.next()}if(prevItem[0]){nextSelectedId=prevItem.attr("target")}else{var hide1=$tab.find(".hide-title-list li").eq(0);if(hide1[0]){nextSelectedId=hide1.attr("item-id")}}headerItem.remove();$tab.children("div").children("#"+tabId).remove();var head=$tab.children("ul");var titles=head.find(".tab-header-items ul").children();var hideTitles=$tab.find(".tab-overflow-items").children();var visibleWidth=0;titles.each(function(){visibleWidth+=$(this).outerWidth()});var j;var headerWidth=head.children(".tab-header-items").outerWidth();for(j=0;j<hideTitles.length;j++){visibleWidth+=parseInt(hideTitles.eq(j).attr("real-width"));if(visibleWidth>=headerWidth){break}}for(var k=0;k<j;k++){hideTitles.eq(k).appendTo($tab.find(".tab-header-items").children("ul"));$tab.find(".hide-title-list").children().eq(k).remove()}if(selected&&nextSelectedId){selectTab($tab,nextSelectedId)}}function removeTabs($tab,items){items.each(function(){removeTab($tab,$(this).attr("target"))
})}function selectTab($tab,tabId){var headItems=$tab.find(".tab-header-items");var tab=headItems.find("li[target="+tabId+"]");if(tab[0]){tab.addClass("tab-header-selected").siblings().removeClass("tab-header-selected")}else{tab=$tab.find(".tab-overflow-items").children("li[target="+tabId+"]");if(tab[0]){headItems.find("ul li").removeClass("tab-header-selected");tab.addClass("tab-header-selected").appendTo(headItems.children("ul"));$tab.find(".hide-title-list").children("li[item-id="+tabId+"]").remove()}}$tab.find("#"+tabId).removeClass("hide").siblings().addClass("hide");afterAddTab($tab)}function isSelected($tab,tabId){return $tab.find("li[target="+tabId+"]").hasClass("tab-header-selected")}function isExists($tab,tabId){return $tab.find("li[target="+tabId+"]")[0]!=undefined}$.fn.tab=function(options,param){if(typeof options=="string"){switch(options){case"addTab":return this.each(function(){addTab($(this),param)});case"addRemoteTab":return this.each(function(){addRemoteTab($(this),param)});case"removeTab":return this.each(function(){removeTab($(this),param)});case"selectTab":return this.each(function(){selectTab($(this),param)});case"isSelected":return isSelected($(this),param);case"isExists":return isExists($(this),param)}}options=options||{};return this.each(function(){var tab=$(this);initTab(tab);initContextMenu();initContentHeight(tab);initEvents(tab);initWindowContextMenu()})}})(jQuery);
(function($){function _initTree($tree){$tree.find("li[class!='node'][class!='folder']").addClass("node").end().find("li:has('ul')").removeClass("node").addClass("folder");$tree.find("li").children("a").find("span").remove().end().prepend("<span><span>");$tree.find("li.folder").children("ul").css("display","none");$tree.find("li.folder[open]").addClass("open").children("ul").css("display","block")}function _bindEvent($tree,options){$tree.find("li.folder > a").unbind().on("click",function(e){var f=$(this).parent();if(f.hasClass("open")){f.removeClass("open").children("ul").css("display","none")}else{if(f.children("ul").length==0){_loadNodes(f,options)}f.addClass("open").children("ul").css("display","block")}}).attr("href","javascript:void(0);")}function _createNodes($target,data,options){if(!data||data.length==0){return""}var $ul=$("<ul></ul>");for(var i=0;i<data.length;i++){var d=data[i];var $node=$("<li></li>").addClass("node").attr("node-id","tree-node-"+d["id"]);var $a=$("<a></a>").html(d["text"]).prepend("<span><span>");if(d["url"]){$a.attr("href",d["url"])}else{if(options["onClick"]&&!d["type"]){$a.attr("href","javascript:void(0);").click((function(d){return function(){options["onClick"](d)}})(d))}else{$a.attr("href","javascript:void(0);")}}$node.append($a);if(d["type"]||(d["children"]&&d["children"].length>0)){var $nodes=_createNodes($target,d["children"],options);$node.append($nodes).removeClass("node").addClass("folder");if(d["open"]){$node.attr("open","");_loadNodes($node,options)}}$ul.append($node)}return $ul}function _loadNodes($target,options){if(!options["url"]){return}var id=0;if($target&&$target.attr("node-id")){id=$target.attr("node-id").replace("tree-node-","")}$.ajax({type:"get",dataType:"json",url:options["url"]+"?id="+id,cache:false,async:false,success:function(data){$target.append(_createNodes($target,data,options));_initTree($target);_bindEvent($target,options)}})}function open($tree,folderNodeId){var f=$tree.find("li[node-id='tree-node-"+folderNodeId+"']");
if(!f[0]||!f.hasClass("folder")){return}var options=$.data($tree[0],"tree");if(f.children("ul").length==0){_loadNodes(f,options)}f.addClass("open").children("ul").css("display","block")}function close($tree,folderNodeId){var f=$tree.find("li[node-id='tree-node-"+folderNodeId+"']");if(!f[0]||!f.hasClass("folder")){return}f.removeClass("open").children("ul").css("display","none")}function openAll($tree){var fs=$tree.find("li[class='folder']");while(fs.length>0){for(var i=0;i<fs.length;i++){open($tree,fs.eq(i).attr("node-id").replace("tree-node-",""))}fs=$tree.find("li[class='folder']")}}function closeAll($tree){var fs=$tree.find("li.folder.open");while(fs.length>0){for(var i=0;i<fs.length;i++){close($tree,fs.eq(i).attr("node-id").replace("tree-node-",""))}fs=$tree.find("li.folder.open")}}function reload($tree,folderNodeId){var f=$tree.find("li[node-id='tree-node-"+folderNodeId+"']");if(!f[0]||!f.hasClass("folder")){return}var options=$.data($tree[0],"tree");f.children("ul").remove();_loadNodes(f,options);if(f.children("ul").length==0){f.removeClass("open").removeClass("folder").addClass("node");f.children("a").off().attr("href","javascript:void(0);");if(options["onClick"]){var d={id:"tree-node-"+folderNodeId,text:f.children("a").text(),children:[],open:false,type:"",url:""};f.children("a").click((function(d){return function(){options["onClick"](d)}})(d))}}if(f.hasClass("open")){f.children("ul").css("display","block")}else{f.children("ul").css("display","none")}}$.fn.tree=function(options,param){if(typeof options=="string"){switch(options){case"open":return this.each(function(){open($(this),param)});case"close":return this.each(function(){close($(this),param)});case"openAll":return this.each(function(){openAll($(this))});case"closeAll":return this.each(function(){closeAll($(this))});case"reload":return this.each(function(){reload($(this),param)})}}options=options||{};return this.each(function(){$.data(this,"tree",options);var tree=$(this).addClass("st_tree");var nodes=_createNodes(tree,options["data"],options);
tree.append(nodes);_loadNodes(tree,options);_initTree(tree);_bindEvent(tree,options)})}})(jQuery);
